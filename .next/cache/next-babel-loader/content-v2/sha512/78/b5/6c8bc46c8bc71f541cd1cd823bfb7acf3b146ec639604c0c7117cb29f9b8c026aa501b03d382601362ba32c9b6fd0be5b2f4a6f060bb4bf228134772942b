{"ast":null,"code":"import { getUserWebsites } from 'lib/queries';\nimport { useAuth } from 'lib/middleware';\nimport { ok, methodNotAllowed, unauthorized } from 'lib/response';\nexport default (async (req, res) => {\n  await useAuth(req, res);\n  const {\n    user_id: current_user_id,\n    is_admin\n  } = req.auth;\n  const {\n    user_id\n  } = req.query;\n  const userId = +user_id;\n\n  if (req.method === 'GET') {\n    if (userId && userId !== current_user_id && !is_admin) {\n      return unauthorized(res);\n    }\n\n    const websites = await getUserWebsites(userId || current_user_id);\n    return ok(res, websites);\n  }\n\n  return methodNotAllowed(res);\n});","map":null,"metadata":{},"sourceType":"module"}