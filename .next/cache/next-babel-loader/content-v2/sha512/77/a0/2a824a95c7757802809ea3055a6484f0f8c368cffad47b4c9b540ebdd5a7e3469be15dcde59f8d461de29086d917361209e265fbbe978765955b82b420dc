{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport React, { useState } from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { Formik, Form, Field } from 'formik';\nimport { useRouter } from 'next/router';\nimport Button from 'components/common/Button';\nimport FormLayout, { FormButtons, FormError, FormMessage, FormRow } from 'components/layout/FormLayout';\nimport Icon from 'components/common/Icon';\nimport Logo from 'assets/logo.svg';\nimport styles from './LoginForm.module.css';\nimport usePost from 'hooks/usePost';\n\nconst validate = ({\n  username,\n  password\n}) => {\n  const errors = {};\n\n  if (!username) {\n    errors.username = /*#__PURE__*/_jsx(FormattedMessage, {\n      id: \"label.required\",\n      defaultMessage: \"Required\"\n    });\n  }\n\n  if (!password) {\n    errors.password = /*#__PURE__*/_jsx(FormattedMessage, {\n      id: \"label.required\",\n      defaultMessage: \"Required\"\n    });\n  }\n\n  return errors;\n};\n\nexport default function LoginForm() {\n  const post = usePost();\n  const router = useRouter();\n  const {\n    0: message,\n    1: setMessage\n  } = useState();\n\n  const handleSubmit = async ({\n    username,\n    password\n  }) => {\n    const {\n      ok,\n      status,\n      data\n    } = await post('/api/auth/login', {\n      username,\n      password\n    });\n\n    if (ok) {\n      return router.push('/');\n    } else {\n      setMessage(status === 401 ? /*#__PURE__*/_jsx(FormattedMessage, {\n        id: \"message.incorrect-username-password\",\n        defaultMessage: \"Incorrect username/password.\"\n      }) : data);\n    }\n  };\n\n  return /*#__PURE__*/_jsx(FormLayout, {\n    className: styles.login,\n    children: /*#__PURE__*/_jsx(Formik, {\n      initialValues: {\n        username: '',\n        password: ''\n      },\n      validate: validate,\n      onSubmit: handleSubmit,\n      children: () => /*#__PURE__*/_jsxs(Form, {\n        children: [/*#__PURE__*/_jsxs(\"div\", {\n          className: styles.header,\n          children: [/*#__PURE__*/_jsx(Icon, {\n            icon: /*#__PURE__*/_jsx(Logo, {}),\n            size: \"xlarge\",\n            className: styles.icon\n          }), /*#__PURE__*/_jsx(\"h1\", {\n            className: \"center\",\n            children: \"umami\"\n          })]\n        }), /*#__PURE__*/_jsxs(FormRow, {\n          children: [/*#__PURE__*/_jsx(\"label\", {\n            htmlFor: \"username\",\n            children: /*#__PURE__*/_jsx(FormattedMessage, {\n              id: \"label.username\",\n              defaultMessage: \"Username\"\n            })\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            children: [/*#__PURE__*/_jsx(Field, {\n              name: \"username\",\n              type: \"text\"\n            }), /*#__PURE__*/_jsx(FormError, {\n              name: \"username\"\n            })]\n          })]\n        }), /*#__PURE__*/_jsxs(FormRow, {\n          children: [/*#__PURE__*/_jsx(\"label\", {\n            htmlFor: \"password\",\n            children: /*#__PURE__*/_jsx(FormattedMessage, {\n              id: \"label.password\",\n              defaultMessage: \"Password\"\n            })\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            children: [/*#__PURE__*/_jsx(Field, {\n              name: \"password\",\n              type: \"password\"\n            }), /*#__PURE__*/_jsx(FormError, {\n              name: \"password\"\n            })]\n          })]\n        }), /*#__PURE__*/_jsx(FormButtons, {\n          children: /*#__PURE__*/_jsx(Button, {\n            type: \"submit\",\n            variant: \"action\",\n            children: /*#__PURE__*/_jsx(FormattedMessage, {\n              id: \"label.login\",\n              defaultMessage: \"Login\"\n            })\n          })\n        }), /*#__PURE__*/_jsx(FormMessage, {\n          children: message\n        })]\n      })\n    })\n  });\n}","map":null,"metadata":{},"sourceType":"module"}