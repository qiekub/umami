{"ast":null,"code":"import { useState, useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { updateUser } from 'redux/actions/user';\nimport { useRouter } from 'next/router';\nimport { get } from 'lib/web';\nexport default function useRequireLogin() {\n  const router = useRouter();\n  const dispatch = useDispatch();\n  const storeUser = useSelector(state => state.user);\n  const {\n    0: loading,\n    1: setLoading\n  } = useState(!storeUser);\n  const {\n    0: user,\n    1: setUser\n  } = useState(storeUser);\n\n  async function loadUser() {\n    setLoading(true);\n    const {\n      ok,\n      data\n    } = await get(`${router.basePath}/api/auth/verify`);\n\n    if (!ok) {\n      return router.push('/login');\n    }\n\n    await dispatch(updateUser(data));\n    setUser(user);\n    setLoading(false);\n  }\n\n  useEffect(() => {\n    if (!loading && user) {\n      return;\n    }\n\n    loadUser();\n  }, []);\n  return {\n    user,\n    loading\n  };\n}","map":null,"metadata":{},"sourceType":"module"}