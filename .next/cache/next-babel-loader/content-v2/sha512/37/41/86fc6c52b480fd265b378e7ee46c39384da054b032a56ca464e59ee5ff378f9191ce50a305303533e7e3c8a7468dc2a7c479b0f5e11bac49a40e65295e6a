{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _defineProperty from \"/Users/t/Documents_2/Work/Qiekub/code/umami/umami/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"/Users/t/Documents_2/Work/Qiekub/code/umami/umami/node_modules/next/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectWithoutProperties from \"/Users/t/Documents_2/Work/Qiekub/code/umami/umami/node_modules/next/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useMemo } from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport firstBy from 'thenby';\nimport classNames from 'classnames';\nimport Link from 'components/common/Link';\nimport Loading from 'components/common/Loading';\nimport useFetch from 'hooks/useFetch';\nimport Arrow from 'assets/arrow-right.svg';\nimport { percentFilter } from 'lib/filters';\nimport useDateRange from 'hooks/useDateRange';\nimport usePageQuery from 'hooks/usePageQuery';\nimport useShareToken from 'hooks/useShareToken';\nimport ErrorMessage from 'components/common/ErrorMessage';\nimport DataTable from './DataTable';\nimport { DEFAULT_ANIMATION_DURATION, TOKEN_HEADER } from 'lib/constants';\nimport styles from './MetricsTable.module.css';\nexport default function MetricsTable(_ref) {\n  var websiteId = _ref.websiteId,\n      type = _ref.type,\n      className = _ref.className,\n      dataFilter = _ref.dataFilter,\n      filterOptions = _ref.filterOptions,\n      limit = _ref.limit,\n      onDataLoad = _ref.onDataLoad,\n      props = _objectWithoutProperties(_ref, [\"websiteId\", \"type\", \"className\", \"dataFilter\", \"filterOptions\", \"limit\", \"onDataLoad\"]);\n\n  var shareToken = useShareToken();\n\n  var _useDateRange = useDateRange(websiteId),\n      _useDateRange2 = _slicedToArray(_useDateRange, 1),\n      dateRange = _useDateRange2[0];\n\n  var startDate = dateRange.startDate,\n      endDate = dateRange.endDate,\n      modified = dateRange.modified;\n\n  var _usePageQuery = usePageQuery(),\n      resolve = _usePageQuery.resolve,\n      router = _usePageQuery.router,\n      url = _usePageQuery.query.url;\n\n  var _useFetch = useFetch(\"/api/website/\".concat(websiteId, \"/metrics\"), {\n    params: {\n      type: type,\n      start_at: +startDate,\n      end_at: +endDate,\n      url: url\n    },\n    onDataLoad: onDataLoad,\n    delay: DEFAULT_ANIMATION_DURATION,\n    headers: _defineProperty({}, TOKEN_HEADER, shareToken === null || shareToken === void 0 ? void 0 : shareToken.token)\n  }, [modified]),\n      data = _useFetch.data,\n      loading = _useFetch.loading,\n      error = _useFetch.error;\n\n  var filteredData = useMemo(function () {\n    if (data) {\n      var items = percentFilter(dataFilter ? dataFilter(data, filterOptions) : data);\n\n      if (limit) {\n        return items.filter(function (e, i) {\n          return i < limit;\n        }).sort(firstBy('y', -1).thenBy('x'));\n      }\n\n      return items.sort(firstBy('y', -1).thenBy('x'));\n    }\n\n    return [];\n  }, [data, error, dataFilter, filterOptions]);\n  return /*#__PURE__*/_jsxs(\"div\", {\n    className: classNames(styles.container, className),\n    children: [!data && loading && /*#__PURE__*/_jsx(Loading, {}), error && /*#__PURE__*/_jsx(ErrorMessage, {}), data && !error && /*#__PURE__*/_jsx(DataTable, _objectSpread(_objectSpread({}, props), {}, {\n      data: filteredData,\n      className: className\n    })), /*#__PURE__*/_jsx(\"div\", {\n      className: styles.footer,\n      children: data && !error && limit && /*#__PURE__*/_jsx(Link, {\n        icon: /*#__PURE__*/_jsx(Arrow, {}),\n        href: router.pathname,\n        as: resolve({\n          view: type\n        }),\n        size: \"small\",\n        iconRight: true,\n        children: /*#__PURE__*/_jsx(FormattedMessage, {\n          id: \"label.more\",\n          defaultMessage: \"More\"\n        })\n      })\n    })]\n  });\n}","map":null,"metadata":{},"sourceType":"module"}